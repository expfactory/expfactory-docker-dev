{% extends "main/base.html" %}
{% load staticfiles%}
{% block head %}
<link rel="stylesheet" href="{% static "css/select2.min.css" %}" />
<link rel="stylesheet" href="//code.jquery.com/ui/1.11.4/themes/smoothness/jquery-ui.css">
{% endblock %}
{% block content %}
<div class="row">

    <div class="col-md-12">

        <!-- Content -->
        <article id="content">
            <header>
                <h2>New Experiment <i style="font-size:12" data-toggle="tooltip" title="You can install experiments from any valid Github repo, including the selection offered by the experiment factory." class="fa fa-question-circle"></i></h2>
            </header>

            <form action="{% url 'save_experiment' bid %}" method="post">

             {% csrf_token %}
              <div class="form-group">
                <label for="experiment">View Expfactory Repo:</label>
                <select class="form-control" id="repo" name="repo">
                  <option>--</option>
                      <option value="https://www.github.com/expfactory/expfactory-experiments">Expfactory-Experiments</option>
                      <option value="https://www.github.com/expfactory/expfactory-surveys">Expfactory-Surveys</option>
                      <option value="https://www.github.com/expfactory/expfactory-games">Expfactory-Games</option>
                </select>
              </div>
             <input type="submit" value="Add">
           </form>

        </article>
    </div>
</div>


{% endblock %}
{% block scripts %}
<script src="{% static "js/select2.min.js"%}" type="text/javascript"></script>
<script src="//code.jquery.com/ui/1.11.4/jquery-ui.js"></script>
{% include 'routes/loading.html' %}
<script>

$(document).ready(function() {

    // Selection of a new experiment clears the table, fills in options
    $("#repo").select2();
    $("#repo").change(function(){
        var selected_repo = $("#repo").val()

        // Function to retrieve experiments
        var url = "/routes/repos/view?url=" + encodeURIComponent(selected_repo)

        // Retrieve point list
        $.ajax({
                type: "GET",
                url: url,
                // if this were not local, would want csrftoken here under data
                complete: function (data, error){
                   var results = JSON.parse(data.responseText);
                   console.log(results)           
                },
                dataType: 'html',
        });
    });

});


</script>
{% endblock %}
